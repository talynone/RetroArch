jobs:
  build:
    runs-on: windows-arm64

    steps:
      - uses: actions/checkout@v4
        with:
          submodules: recursive

      # VS 2022 + ARM64 tools are already present on the arm64 image;
      # you can usually skip msvc-dev-cmd, or still call it with arch: arm64
      - name: Set up MSVC 2022 (native ARM64)
        uses: ilammy/msvc-dev-cmd@v1
        with:
          arch: arm64
          vsversion: '2022'

      - name: Restore NuGet packages
        run: nuget restore pkg\msvc\RetroArch-msvc2022.sln

      - name: Build RetroArch (Release | ARM64)
        run: |
          msbuild pkg\msvc\RetroArch-msvc2022.sln ^
            /p:Configuration=Release ^
            /p:Platform=ARM64 ^
            /m

      - name: Upload ARM64 build artifacts
        uses: actions/upload-artifact@v4
        with:
          name: retroarch-windows-arm64-msvc2022-native
          path: |
            **\retroarch.exe
            **\*.dll
